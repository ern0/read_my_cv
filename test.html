<!DOCTYPE html>
  <html>
    <body onload = "initialize()">

      <script src="controller.js"></script>

      <script>
        function initialize() {
          const controller = {
            element: undefined,
            visible: 0 // TODO: Read URL to determine if controller is to start visible or invisible
          }

          const input = {
            text: "",
            at: undefined
          }

          function onKey(event) {
            const keyNow = Date.now();
            const keyThen = input.at;

            const ignoreKeys = ["Alt", "Control", "Shift"];
            const resetKeys = ["Backspace", "Delete", "Escape"];

            const secret = {
              text: "Bob",
              timeout: 2000 // ms
            }

            const key = event.key;

            if ((ignoreKeys.includes(key) || event.isComposing || event.keyCode === 229)) { // 229 is a special value set for a keyCode relating to an event that has been processed by an input-method editor -- TODO: Use event.code and appropriate string value! 
              return;
            }

            input.at = keyNow;
            const reset = resetKeys.includes(key);
            const timeout = keyNow - keyThen > secret.timeout;

            if ((reset) || (timeout)) {
              input.text = "";

              if (reset) {
                return;
              }
            }

            input.text += key;

            if (input.text != secret.text) {
              return;
            }

            setVisibleByElement(controller.element, 1);
            document.removeEventListener("keyup", onKey);
            controller.visible = 1;
          }

          controller.element = prependController(document.body, "controlled", controller.visible);
          document.addEventListener("keyup", onKey);
        }
 
      </script>

      <h1>Output</h1>

      <p>
        <div class="test" controlled="Bob">
          This is Bob
        </div>

        <div class="test" controlled="Billy">
          This is Billy
        </div>

        <div class="test" controlled="Sam">
          This is Sam
        </div>
      </p>

    </body>
</html>